<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.18">
<title>Assignment 02: C shell by the shore</title>
<link rel="stylesheet" href="../style/cs21.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_assignment_02_c_shell_by_the_shore">Assignment 02: C shell by the shore</a></li>
<li><a href="#_microcat">1. Microcat</a></li>
<li><a href="#_parser">2. Parser</a></li>
<li><a href="#_grading_rubric">3. Grading Rubric</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_assignment_02_c_shell_by_the_shore">Assignment 02: C shell by the shore</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Due Tuesday, Feb 3, before midnight</strong></p>
</div>
<div class="paragraph">
<p>The goals for this assignment are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Working with stdout, stdin, and files</p>
</li>
<li>
<p>Understanding redirection and pipes at the command line</p>
</li>
<li>
<p>Working with system calls: read, write, open</p>
</li>
<li>
<p>C practice</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This is the first assignment of your shell project. To get started,
click on this <a href="https://classroom.github.com/a/j-ws2ho7">Shell Project on Github</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_microcat">1. Microcat</h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>By Dianna Xu</em></p>
</div>
<div class="paragraph">
<p>In the file, <code>microcat.c</code>, implement a C program that concatenates and prints files
to standard output. If no arguments are given, it takes input from stdin.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ <strong>./microcat lyrics.txt</strong>
What a beautiful face
I have found in this place
That is circling all round the sun
What a beautiful dream
That could flash on the screen
In a blink of an eye and be gone from me
Soft and sweet
Let me hold it close and keep it here with me
$ <strong>cat lyrics.txt | ./microcat</strong>
What a beautiful face
I have found in this place
That is circling all round the sun
What a beautiful dream
That could flash on the screen
In a blink of an eye and be gone from me
Soft and sweet
Let me hold it close and keep it here with me
$ <strong>./microcat < lyrics.txt</strong>
What a beautiful face
I have found in this place
That is circling all round the sun
What a beautiful dream
That could flash on the screen
In a blink of an eye and be gone from me
Soft and sweet
Let me hold it close and keep it here with me
$ <strong>./microcat</strong>
<strong>hello</strong>
hello
<strong>nice hat</strong>
nice hat
$ <strong>./microcat B.txt A.txt C.txt D.txt</strong>
World
Hello
!!!
All life is precious</code></pre>
</div>
</div>
<div class="paragraph">
<p>Requirements/Hints:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the low-level system calls for working with files: read, write, open</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_parser">2. Parser</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This question is from <a href="https://www.cs.swarthmore.edu/~kwebb/cs45/s24/labs/lab1.html">this lab</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the file, <code>parser.c</code>, implement a function that parses command line input.
This function should fill in a <code>struct Cmd</code> that holds the information needed to execute. Your struct should look as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>struct Cmd {
  char **cmd1_argv;
  char **cmd2_argv;
  char *cmd1_fds[3];
  char *cmd2_fds[3];
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Sample output from your program should look as follows:</p>
</div>
<div class="paragraph">
<p>Plain command: <code>ls -l</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>cmd1_args: ["ls", "-l", NULL]  /* three-element dynamically-allocated array */
cmd2_args: NULL  /* There is no second command here. */

cmd1_fds[0]: NULL  /* With no I/O redirects, all descriptors are NULL */
cmd1_fds[1]: NULL
cmd1_fds[2]: NULL

cmd2_fds[0]: NULL
cmd2_fds[1]: NULL
cmd2_fds[2]: NULL</code></pre>
</div>
</div>
<div class="paragraph">
<p>Pipe only command: <code>ls | sort</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>cmd1_args: ["ls", NULL]  /* two-element dynamically-allocated array containing */
cmd2_args: ["sort", NULL]  /* two-element dynamically-allocated array containing */

cmd1_fds[0]: NULL  /* With no I/O redirects, all descriptors are NULL */
cmd1_fds[1]: NULL
cmd1_fds[2]: NULL

cmd2_fds[0]: NULL
cmd2_fds[1]: NULL
cmd2_fds[2]: NULL</code></pre>
</div>
</div>
<div class="paragraph">
<p>Redirects only: <code>ls -l 1&gt; out.txt 2&gt; error.txt</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>cmd1_args: ["ls", "-l", NULL]  /* three-element dynamically-allocated array */

cmd2_args: NULL  /* There is no second command here. */

cmd1_fds[0]: NULL
cmd1_fds[1]: "out.txt"
cmd1_fds[2]: "error.txt"

cmd2_fds[0]: NULL  /* There is no second command here. */
cmd2_fds[1]: NULL
cmd2_fds[2]: NULL</code></pre>
</div>
</div>
<div class="paragraph">
<p>Combined: <code>grep -i blah &lt; input.txt | sort 1&gt; output.txt</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>cmd1_args: ["grep", "-i", "blah", NULL]  /* four-element dynamically-allocated array */
cmd2_args: ["sort", NULL]  /* two-element dynamically-allocated array containing */

cmd1_fds[0]: "input.txt"
cmd1_fds[1]: NULL
cmd1_fds[2]: NULL

cmd2_fds[0]: NULL
cmd2_fds[1]: "output.txt"
cmd2_fds[2]: NULL</code></pre>
</div>
</div>
<div class="paragraph">
<p>Requirements/Hints:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use only C commands, such as malloc/free, for this program</p>
</li>
<li>
<p>The comments above are to help you understand what memory you should allocate. Don&#8217;t print the information in the comments.</p>
</li>
<li>
<p>Make sure you have no memory errors!</p>
</li>
<li>
<p>You can extend the above struct if you like, but don&#8217;t change the given data types!</p>
</li>
<li>
<p>You can assume that you will have at most one pipe</p>
</li>
<li>
<p>Note that the 2&gt; error.txt, |, and &amp; portions of the command are instructions to the shell and are NOT command ARGV tokens.</p>
</li>
<li>
<p>To simplify parsing, you may assume that nothing other than white space (spaces, newlines, etc.) will appear after an ampersand (&amp;), there will be at most one ampersand, and that ampersands will not appear for any reason other than to specify background tasks.</p>
</li>
</ul>
</div>
<h3 id="_submit_your_work_to_github" class="discrete">Submit your work to Github</h3>
<div class="paragraph">
<p>Add and check in your program using git and then push your changes to Github.
Run the following command inside your <code>shell-USERNAME</code> directory.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ cd shell-USERNAME
$ git add .
$ git commit -m "Descriptive message"
$ git push</code></pre>
</div>
</div>
<div class="paragraph">
<p>Run <code>git status</code> to check the result of the previous git command.
Check the Github website to make sure that your program uploaded correctly.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_grading_rubric">3. Grading Rubric</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Assignment rubrics</strong></p>
</div>
<div class="paragraph">
<p>Grades are out of 4 points.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>(2 points) Microcat</p>
</li>
<li>
<p>(2 points) Parser</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Code rubrics</strong></p>
</div>
<div class="paragraph">
<p>For full credit, your C programs must be feature-complete, robust (e.g. run without memory errors or crashing) and
have good style.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Some credit lost for missing features or bugs, depending on severity of error</p>
</li>
<li>
<p>-12.5% for style errors. See the <a href="../codingstandard.html">class coding style</a> here.</p>
</li>
<li>
<p>-50% for memory errors</p>
</li>
<li>
<p>-100% for failure to checkin work to Github</p>
</li>
<li>
<p>-100% for failure to compile on linux using make</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2026-01-28 16:13:39 -0500
</div>
</div>
</body>
</html>